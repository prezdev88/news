<div class="panel grid" style="gap: 20px;">
  <section>
    <h3>Nueva entrada</h3>
    <form class="creator" [formGroup]="entryForm" (ngSubmit)="submitEntry()" style="display: flex; flex-direction: column; gap: 12px; width: 100%;">
      <div formArrayName="sources" style="display: flex; flex-direction: column; gap: 12px; width: 100%;">
        <div>
          <strong>Fuentes</strong>
          <div style="color: var(--muted); font-size: 13px;">Puedes agregar todas las que necesites.</div>
          <button type="button" (click)="addSource()" style="margin-top: 8px; width: 100%;">AÃ±adir fuente</button>
        </div>
        <div *ngFor="let src of sources.controls; let i = index" class="source-row" [formGroupName]="i" style="display: flex; flex-direction: column; gap: 8px; width: 100%;">
          <input placeholder="URL (https://...)" formControlName="url" style="width: 100%;">
          <div style="display: flex; gap: 8px; width: 100%;">
          <button type="button" (click)="removeSource(i)" *ngIf="sources.length > 1" style="flex: 1;">Eliminar</button>
        </div>
      </div>
    </div>

      <label style="width: 100%;">
        <span>Headline *</span>
        <input type="text" formControlName="headline" required style="width: 100%;">
      </label>

      <label style="width: 100%;">
        <span>Fecha *</span>
        <input type="date" formControlName="date" required style="width: 100%;">
      </label>

      <label style="width: 100%;">
        <span>Hashtags (coma)</span>
        <input type="text" placeholder="kast,venezuela" formControlName="hashtags" style="width: 100%;">
      </label>

      <div style="align-self: end; margin-top: 12px;">
        <button type="submit" [disabled]="entryForm.invalid || loading()" style="width: 100%;">Crear</button>
      </div>
    </form>
  </section>

  <section>
    <h3>Hashtags recientes</h3>
    <div style="margin-top: 6px;">
      <div class="badge" *ngFor="let tag of hashtags()">#{{ tag }}</div>
    </div>
  </section>
</div>

<section style="margin-top: 24px;" class="panel">
  <div style="display: flex; justify-content: space-between; align-items: center;">
    <h3 style="margin: 0;">Entradas</h3>
    <div *ngIf="loading()" style="color: var(--muted);">Cargando...</div>
  </div>

  <div class="grid" style="margin-top: 12px;">
    <div *ngFor="let entry of entries()" class="entry-card">
      <div class="entry-date">{{ entry.date }}</div>
      <div class="entry-headline">{{ entry.headline }}</div>
      <div style="margin: 8px 0;">
        <span class="tag" *ngFor="let tag of entry.hashtags">#{{ tag }}</span>
      </div>
      <div class="sources" *ngIf="entry.sources?.length">
        Fuentes:
        <span *ngFor="let s of entry.sources; let i = index">[{{ i + 1 }}] <a [href]="s.url" target="_blank">{{ hostFromUrl(s.url) }}</a> </span>
      </div>
    </div>
  </div>
</section>
